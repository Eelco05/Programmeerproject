<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>View of an Archaeological survey</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/style.css">
    <!-- <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script> -->
    <script type="text/javascript" src="js/d3.min.js"></script>
    <script type="text/javascript" src="js/d3-legend.min.js"></script>
    <script type="text/javascript" src="js/d3-tip.js"></script>
    <!-- <script type="text/javascript" src="js/datamaps.world.min.js"></script>
    <script type="text/javascript" src="https://d3js.org/d3-dsv.v1.min.js"></script> -->
</head>
<body>
    <h1>Sacred Landscape Project, Molise, Italy</h1>
    <nav class="fixed-nav-bar">
        <div class="nav">
            <ul class="nav">
                <li><a href="index.html">Home</a></li>
                <li><a href="intro.html">Intro</a></li>
                <li><a href="findtypes.html">Find types</a></li>
                <li><a href="findperiod.html">Finds per period</a></li>
                <li><a href="converter.html">Converter</a></li>
                <li><a href="tester.html">Tester</a></li>
                <li><a href="http://surveyarchaeology.eu/tiki-index.php?page=Sacred%20Landscape%20Project">SLP</a></li>
            </ul>
        </div>
    </nav>
	<pre id="json"></pre>
    <script>
        d3.csv('data/SLP_total_magled_by_period_red.csv', function(data) {

            var type = d3.nest()
            .key(function(d) { return d.Campaign; })
            .key(function(d) { return d.Period })
            // .key(function(d) { return "High : "+d.high})
            // .key(function(d) { return "SLP"+d.Campaign.split("-")[1]; })
            .rollup(function(e) { return { 
                "Number": d3.sum(e, function(d) { return +d.Number; }),
              }
            })
            .entries(data);

            document.getElementById("json").innerHTML = JSON.stringify(type, undefined, 3);

            console.log("json_type", type)
        });
        d3.json('data/finds_period.json', function(data) {

            json = data;

            console.log("finds_period", json)
        });

        d3.csv("data/meta/SLP_total_magled.csv", function(data) {
            
            data.sort(function(a,b) { b.Campaign - a.Campaign;})

            var dataByCampaign = d3.nest()
                .key(function(d) { return d.Campaign; })
                .key(function(d) { return d.Type})
                // .rollup(function(e) { return { 
                //         "total": d3.sum(e, function(d) { return +d.Number; })
                //     }
                // })
                .map(data)

            console.log(dataByCampaign);
        });
            
    </script>
	</body>
</html>
